<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>MP4v2 trunk-r479 PROJECT_name: example/itmf/tags.c</title>
    <link href="project.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="sitebanner">
    <div id="home">
        <a href="http://code.google.com/p/mp4v2"></a>
    </div>
    <div id="title">
        PROJECT_name: example/itmf/tags.c
    </div>
    <div id="menu">
        <ul>
            <li><a href="http://code.google.com/p/mp4v2">MP4v2 Home</a></li>
            <li><a href="../index.html">Documentation</a></li>
            <li class="active">API Reference</li>
        </ul>
    </div>
</div>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>example/itmf/tags.c</h1><div class="fragment"><pre class="fragment"><span class="comment">/* This is an example of iTMF Tags convenience API.</span>
<span class="comment"> * WARNING: this program will change/destroy many tags in an mp4 file.</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;mp4v2/mp4v2.h&gt;</span>

<span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv )
{
    <span class="keywordflow">if</span>( argc != 2 ) {
        printf( <span class="stringliteral">&quot;usage: %s file.mp4\n&quot;</span>, argv[0] );
        <span class="keywordflow">return</span> 1;
    }

    <span class="comment">/* open file for modification */</span>
    MP4FileHandle file = <a name="a0"></a><a class="code" href="group__mp4__file.html#ga3fc8331224485351cfbaec4d0194b623" title="Modify an existing mp4 file.">MP4Modify</a>( argv[1], MP4_DETAILS_ERROR, 0 );
    <span class="keywordflow">if</span>( file == <a name="a1"></a><a class="code" href="group__mp4__general.html#gafa387d447016a2c4fb1bb7e70b6e3b32" title="Constant: invalid MP4FileHandle.">MP4_INVALID_FILE_HANDLE</a> ) {
        printf( <span class="stringliteral">&quot;MP4Modify failed\n&quot;</span> );
        <span class="keywordflow">return</span> 1;
    }

    <span class="comment">/* allocate */</span>
    <span class="keyword">const</span> <a name="_a2"></a><a class="code" href="struct_m_p4_tags__s.html" title="Tags convenience structure.">MP4Tags</a>* tags = <a name="a3"></a><a class="code" href="group__mp4__itmf__tags.html#gaac2391714faf62178f887d9065a51df8" title="Allocate tags convenience structure for reading and settings tags.">MP4TagsAlloc</a>();

    <span class="comment">/* fetch data from MP4 file and populate structure */</span>
    <a name="a4"></a><a class="code" href="group__mp4__itmf__tags.html#gae59ce774f6b966f2f12be21505e5a84f" title="Fetch data from mp4 file and populate structure.">MP4TagsFetch</a>( tags, file );

    <span class="comment">/***************************************************************************</span>
<span class="comment">     * print various tag values</span>
<span class="comment">     */</span>

    <span class="keywordflow">if</span>( tags-&gt;<a name="a5"></a>name )
        printf( <span class="stringliteral">&quot;name: %s\n&quot;</span>, tags-&gt;name );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a6"></a>artist )
        printf( <span class="stringliteral">&quot;artist: %s\n&quot;</span>, tags-&gt;artist );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a7"></a>albumArtist )
        printf( <span class="stringliteral">&quot;albumArtist: %s\n&quot;</span>, tags-&gt;albumArtist );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a8"></a>album )
        printf( <span class="stringliteral">&quot;album: %s\n&quot;</span>, tags-&gt;album );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a9"></a>grouping )
        printf( <span class="stringliteral">&quot;grouping: %s\n&quot;</span>, tags-&gt;grouping );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a10"></a>composer )
        printf( <span class="stringliteral">&quot;composer: %s\n&quot;</span>, tags-&gt;composer );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a11"></a>comments )
        printf( <span class="stringliteral">&quot;comments: %s\n&quot;</span>, tags-&gt;comments );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a12"></a>genre )
        printf( <span class="stringliteral">&quot;genre: %s\n&quot;</span>, tags-&gt;genre );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a13"></a>genreType )
        printf( <span class="stringliteral">&quot;genreType: %u\n&quot;</span>, *tags-&gt;genreType );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a14"></a>releaseDate )
        printf( <span class="stringliteral">&quot;releaseDate: %s\n&quot;</span>, tags-&gt;releaseDate );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a15"></a>track )
        printf( <span class="stringliteral">&quot;track: index=%u total=%u\n&quot;</span>, tags-&gt;track-&gt;<a name="a16"></a>index, tags-&gt;track-&gt;<a name="a17"></a>total );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a18"></a>disk )
        printf( <span class="stringliteral">&quot;disk: index=%u total=%u\n&quot;</span>, tags-&gt;disk-&gt;<a name="a19"></a>index, tags-&gt;disk-&gt;<a name="a20"></a>total );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a21"></a>tempo )
        printf( <span class="stringliteral">&quot;tempo: %u\n&quot;</span>, *tags-&gt;tempo );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a22"></a>compilation )
        printf( <span class="stringliteral">&quot;compilation: %u\n&quot;</span>, *tags-&gt;compilation );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a23"></a>tvShow )
        printf( <span class="stringliteral">&quot;tvShow: %s\n&quot;</span>, tags-&gt;tvShow );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a24"></a>tvNetwork )
        printf( <span class="stringliteral">&quot;tvNetwork: %s\n&quot;</span>, tags-&gt;tvNetwork );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a25"></a>tvEpisodeID )
        printf( <span class="stringliteral">&quot;tvEpisodeID: %s\n&quot;</span>, tags-&gt;tvEpisodeID );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a26"></a>tvSeason )
        printf( <span class="stringliteral">&quot;tvSeason: %u\n&quot;</span>, *tags-&gt;tvSeason );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a27"></a>tvEpisode )
        printf( <span class="stringliteral">&quot;tvEpisode: %u\n&quot;</span>, *tags-&gt;tvEpisode );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a28"></a>description )
        printf( <span class="stringliteral">&quot;description: %s\n&quot;</span>, tags-&gt;description );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a29"></a>longDescription )
        printf( <span class="stringliteral">&quot;longDescription: %s\n&quot;</span>, tags-&gt;longDescription );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a30"></a>lyrics )
        printf( <span class="stringliteral">&quot;lyrics: %s\n&quot;</span>, tags-&gt;lyrics );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a31"></a>sortName )
        printf( <span class="stringliteral">&quot;sortName: %s\n&quot;</span>, tags-&gt;sortName );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a32"></a>sortArtist )
        printf( <span class="stringliteral">&quot;sortArtist: %s\n&quot;</span>, tags-&gt;sortArtist );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a33"></a>sortAlbumArtist )
        printf( <span class="stringliteral">&quot;sortAlbumArtist: %s\n&quot;</span>, tags-&gt;sortAlbumArtist );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a34"></a>sortAlbum )
        printf( <span class="stringliteral">&quot;sortAlbum: %s\n&quot;</span>, tags-&gt;sortAlbum );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a35"></a>sortComposer )
        printf( <span class="stringliteral">&quot;sortComposer: %s\n&quot;</span>, tags-&gt;sortComposer );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a36"></a>sortTVShow )
        printf( <span class="stringliteral">&quot;sortTVShow: %s\n&quot;</span>, tags-&gt;sortTVShow );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a37"></a>artworkCount ) {
        <span class="keyword">const</span> <a name="_a38"></a><a class="code" href="struct_m_p4_tag_artwork__s.html" title="Data object representing a single piece of artwork.">MP4TagArtwork</a>* art = tags-&gt;<a name="a39"></a>artwork; <span class="comment">/* artwork != NULL when artworkCount &gt; 0 */</span>
        uint32_t i;
        <span class="keywordflow">for</span>( i = 0; i &lt; tags-&gt;artworkCount; i++, art++ )
            printf( <span class="stringliteral">&quot;art[%d]: type=%d size=%u data=%p\n&quot;</span>, i, art-&gt;<a name="a40"></a><a class="code" href="struct_m_p4_tag_artwork__s.html#a9e50a9c85c9964542948d3e63f8ba516" title="data type">type</a>, art-&gt;<a name="a41"></a><a class="code" href="struct_m_p4_tag_artwork__s.html#a1d5bd30cbd0754d1023404e5b41c2587" title="data size in bytes">size</a>, art-&gt;<a name="a42"></a><a class="code" href="struct_m_p4_tag_artwork__s.html#aae4eaf86fb5561eade5237532474465b" title="raw picture data">data</a> );
    }

    <span class="keywordflow">if</span>( tags-&gt;<a name="a43"></a>copyright )
        printf( <span class="stringliteral">&quot;copyright: %s\n&quot;</span>, tags-&gt;copyright );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a44"></a>encodingTool )
        printf( <span class="stringliteral">&quot;encodingTool: %s\n&quot;</span>, tags-&gt;encodingTool );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a45"></a>encodedBy )
        printf( <span class="stringliteral">&quot;encodedBy: %s\n&quot;</span>, tags-&gt;encodedBy );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a46"></a>purchaseDate )
        printf( <span class="stringliteral">&quot;purchaseDate: %s\n&quot;</span>, tags-&gt;purchaseDate );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a47"></a>podcast )
        printf( <span class="stringliteral">&quot;podcast: %u\n&quot;</span>, *tags-&gt;podcast );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a48"></a>keywords )
        printf( <span class="stringliteral">&quot;keywords: %s\n&quot;</span>, tags-&gt;keywords );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a49"></a>category )
        printf( <span class="stringliteral">&quot;category: %s\n&quot;</span>, tags-&gt;category );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a50"></a>hdVideo )
        printf( <span class="stringliteral">&quot;hdVideo: %u\n&quot;</span>, *tags-&gt;hdVideo );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a51"></a>mediaType )
        printf( <span class="stringliteral">&quot;mediaType: %u\n&quot;</span>, *tags-&gt;mediaType );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a52"></a>contentRating )
        printf( <span class="stringliteral">&quot;contentRating: %u\n&quot;</span>, *tags-&gt;contentRating );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a53"></a>gapless )
        printf( <span class="stringliteral">&quot;gapless: %u\n&quot;</span>, *tags-&gt;gapless );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a54"></a>contentID )
        printf( <span class="stringliteral">&quot;contentID: %u\n&quot;</span>, *tags-&gt;contentID );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a55"></a>artistID )
        printf( <span class="stringliteral">&quot;artistID: %u\n&quot;</span>, *tags-&gt;artistID );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a56"></a>playlistID )
        printf( <span class="stringliteral">&quot;playlistID: %llu\n&quot;</span>, *tags-&gt;playlistID );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a57"></a>genreID )
        printf( <span class="stringliteral">&quot;genreID: %u\n&quot;</span>, *tags-&gt;genreID );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a58"></a>xid )
        printf( <span class="stringliteral">&quot;xid: %s\n&quot;</span>, tags-&gt;xid );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a59"></a>iTunesAccount )
        printf( <span class="stringliteral">&quot;iTunesAccount: %s\n&quot;</span>, tags-&gt;iTunesAccount );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a60"></a>iTunesAccountType )
        printf( <span class="stringliteral">&quot;iTunesAccountType: %u\n&quot;</span>, *tags-&gt;iTunesAccountType );

    <span class="keywordflow">if</span>( tags-&gt;<a name="a61"></a>iTunesCountry )
        printf( <span class="stringliteral">&quot;iTunesCountry: %u\n&quot;</span>, *tags-&gt;iTunesCountry );

    <span class="comment">/**************************************************************************</span>
<span class="comment">     * modify various tags values</span>
<span class="comment">     */</span>

    uint8_t  n8;
    uint16_t n16;
    uint32_t n32;
    uint64_t n64;

    <a name="_a62"></a><a class="code" href="struct_m_p4_tag_track__s.html">MP4TagTrack</a> dtrack;
    dtrack.index = 1;
    dtrack.total = 1;

    <a name="_a63"></a><a class="code" href="struct_m_p4_tag_disk__s.html">MP4TagDisk</a> ddisk;
    ddisk.index = 1;
    ddisk.total = 1;

    MP4TagsSetName              ( tags, <span class="stringliteral">&quot;my name&quot;</span> );
    MP4TagsSetArtist            ( tags, <span class="stringliteral">&quot;my artist&quot;</span> );
    MP4TagsSetAlbumArtist       ( tags, <span class="stringliteral">&quot;my albumArtist&quot;</span> );
    MP4TagsSetAlbum             ( tags, <span class="stringliteral">&quot;my album&quot;</span> );
    MP4TagsSetGrouping          ( tags, <span class="stringliteral">&quot;my grouping&quot;</span> );
    MP4TagsSetComposer          ( tags, <span class="stringliteral">&quot;my composer&quot;</span> );
    MP4TagsSetComments          ( tags, <span class="stringliteral">&quot;my comments&quot;</span> );
    MP4TagsSetGenre             ( tags, <span class="stringliteral">&quot;my genre&quot;</span> );
    n16 = 5; <span class="comment">/* disco */</span>
    MP4TagsSetGenreType         ( tags, &amp;n16 );
    MP4TagsSetReleaseDate       ( tags, <span class="stringliteral">&quot;my releaseDate&quot;</span> );
    MP4TagsSetTrack             ( tags, &amp;dtrack );
    MP4TagsSetDisk              ( tags, &amp;ddisk );
    n16 = 60; <span class="comment">/* bpm */</span>
    MP4TagsSetTempo             ( tags, &amp;n16 );
    n8 = 0; <span class="comment">/* false */</span>
    MP4TagsSetCompilation       ( tags, &amp;n8 );

    MP4TagsSetTVShow            ( tags, <span class="stringliteral">&quot;my tvShow&quot;</span> );
    MP4TagsSetTVNetwork         ( tags, <span class="stringliteral">&quot;my tvNetwork&quot;</span> );
    MP4TagsSetTVEpisodeID       ( tags, <span class="stringliteral">&quot;my tvEpisodeID&quot;</span> );
    n32 = 0;
    MP4TagsSetTVSeason          ( tags, &amp;n32 );
    n32 = 0;
    MP4TagsSetTVEpisode         ( tags, &amp;n32 );

    MP4TagsSetDescription       ( tags, <span class="stringliteral">&quot;my description&quot;</span> );
    MP4TagsSetLongDescription   ( tags, <span class="stringliteral">&quot;my longDescription&quot;</span> );
    MP4TagsSetLyrics            ( tags, <span class="stringliteral">&quot;my lyrics&quot;</span> );

    MP4TagsSetSortName          ( tags, <span class="stringliteral">&quot;my sortName&quot;</span> );
    MP4TagsSetSortArtist        ( tags, <span class="stringliteral">&quot;my sortArtist&quot;</span> );
    MP4TagsSetSortAlbumArtist   ( tags, <span class="stringliteral">&quot;my sortAlbumArtist&quot;</span> );
    MP4TagsSetSortAlbum         ( tags, <span class="stringliteral">&quot;my sortAlbum&quot;</span> );
    MP4TagsSetSortComposer      ( tags, <span class="stringliteral">&quot;my sortComposer&quot;</span> );
    MP4TagsSetSortTVShow        ( tags, <span class="stringliteral">&quot;my sortTVShow&quot;</span> );

    MP4TagsSetCopyright         ( tags, <span class="stringliteral">&quot;my copyright&quot;</span> );
    MP4TagsSetEncodingTool      ( tags, <span class="stringliteral">&quot;my encodingTool&quot;</span> );
    MP4TagsSetEncodedBy         ( tags, <span class="stringliteral">&quot;my encodedBy&quot;</span> );
    MP4TagsSetPurchaseDate      ( tags, <span class="stringliteral">&quot;my purchaseDate&quot;</span> );

    n8 = 0; <span class="comment">/* false */</span>
    MP4TagsSetPodcast           ( tags, &amp;n8 );
    MP4TagsSetKeywords          ( tags, <span class="stringliteral">&quot;my keywords&quot;</span> );
    MP4TagsSetCategory          ( tags, <span class="stringliteral">&quot;my category&quot;</span> );

    n8 = 0; <span class="comment">/* false */</span>
    MP4TagsSetHDVideo           ( tags, &amp;n8 ); <span class="comment">// false</span>
    n8 = 9; <span class="comment">/* movie */</span>
    MP4TagsSetMediaType         ( tags, &amp;n8 ); <span class="comment">// movie</span>
    n8 = 0; <span class="comment">/* none */</span>
    MP4TagsSetContentRating     ( tags, &amp;n8 ); <span class="comment">// none</span>
    n8 = 0; <span class="comment">/* false */</span>
    MP4TagsSetGapless           ( tags, &amp;n8 ); <span class="comment">// false</span>

    MP4TagsSetITunesAccount     ( tags, <span class="stringliteral">&quot;my iTunesAccount&quot;</span> );
    n8 = 0; <span class="comment">/* iTunes */</span>
    MP4TagsSetITunesAccountType ( tags, &amp;n8 );
    n32 = 143441; <span class="comment">/* USA */</span>
    MP4TagsSetITunesCountry     ( tags, &amp;n32 );
    n32 = 0;
    MP4TagsSetContentID         ( tags, &amp;n32 );
    n32 = 0;
    MP4TagsSetArtistID          ( tags, &amp;n32 );
    n64 = 0;
    MP4TagsSetPlaylistID        ( tags, &amp;n64 );
    n32 = 0;
    MP4TagsSetGenreID           ( tags, &amp;n32 );
    n32 = 0;
    MP4TagsSetComposerID        ( tags, &amp;n32 );
    MP4TagsSetXID               ( tags, <span class="stringliteral">&quot;my prefix:my scheme:my identifier&quot;</span> );

    <span class="comment">/* push data to mp4 file */</span>
    <a name="a64"></a><a class="code" href="group__mp4__itmf__tags.html#ga646f27e46c9154e7867d6784a7c255b7" title="Store data to mp4 file from structure.">MP4TagsStore</a>( tags, file );

    <span class="comment">/* free memory associated with structure and close */</span>
    <a name="a65"></a><a class="code" href="group__mp4__itmf__tags.html#gad5b9e876efc7d50673e05f6100af4d68" title="Free tags convenience structure.">MP4TagsFree</a>( tags );
    <a name="a66"></a><a class="code" href="group__mp4__file.html#ga484d26d892b561ab0a95f9ce79036dfa" title="Close an mp4 file.">MP4Close</a>( file );

    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<div class="footer">
    <div>
        generated on Thu Jul 7 11:02:27 2011 for <b>MP4v2 (trunk-r479)</b>
        by&nbsp;<a href="http://www.doxygen.org">Doxygen</a> 1.6.3
    </div>
</div>
</body>
</html>
